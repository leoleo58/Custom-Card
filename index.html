<!DOCTYPE html>
<html lang="en">
    <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Card Generator</title>
    <style>
        body{
            display: flex;
            margin: 0;
            font-family: 'Comic Sans MS', cursive, sans-serif;
            overflow-x:hidden;
            position: relative;
            flex-direction: column;
            background: #fff0f5;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }
        button{
            font-size: 15px;
            border-radius: 10px;
            padding:10px;
            background:#ff69b4; 
            color:white;
            border: 1px solid #fb8fc5;
        }
        #mainContainer{
            display: flex;
            gap: 30px;
            width: 100%;
            max-width: 1200px;
            align-items: center;
            justify-content: center;
        }
        #title{
            font-size: 25px;
            color: #bc1c6f;
            padding: 10px;
            font-weight: 600;
        }
        #formContainer{
            display: flex;
            flex-direction: column;
            justify-content: center;
            text-align: center;
            align-items: center;
            margin:10px;
            padding: 20px;
            background-color: #ffdbed;
            color:#821866;
            border-radius: 15px;
            font-size: 15px;
            width: 40%;
            gap: 15px;
        }
        input[type="color"]{
            border-radius: 5px;
            border: 1px solid #d9ace2;
        }
        input[type="checkbox"]{
            margin: 8px;
            padding: 10px;
            width: auto;
            border: 1px solid #d9ace2;
        }
        input[type="text"], textarea, select{
            border-radius: 5px;
            border: 1px solid #d9ace2;
            font-size: 15px;
            padding: 10px;
            width: 90%;
            color:#821866;
        }
        
        #cardContainer{
            width:90%; 
            max-width: 1000px;
            aspect-ratio: 1/0.7;
            perspective:1500px; 
            position:relative; 
            z-index:1; 
        }
        .card{
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.2s;
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        .front{
            width: 100%;
            height: 100%;
            display: none;
            background:#fbdafe;
            box-shadow:0 2px 7px rgba(0,0,0,0.3);
            justify-content:center; 
            align-items:center; 
            flex-direction:column;
            position:absolute; 
            backface-visibility:hidden; 
            z-index:3;
            transition: transform 1.5s cubic-bezier(0.4, 0, 0.2, 1);
            transform-origin: left center;
        }
        #openButton{
            cursor: pointer; 
            font-weight: bold; 
            margin-top: 15px; 
            padding: 10px; 
            border: 2px dashed; 
            border-radius: 10px; 
            text-align: center;
        }
        #openButton:hover{
            border: 2px solid;
        }
        .cardinside{
            width: 100%;
            height: 100%;
            display: flex;
            transform-style:preserve-3d;
            transition: transform 1s;
        }
        .left{
            width: 50%;
            height: 100%;
            display: flex;
            position:relative; 
            overflow:hidden;
            display:flex; 
            justify-content:center; 
            align-items:center; 
            flex-direction:column;
            background:#fff0f5;
        }
        .right{
            width: 50%;
            height: 100%;
            display: flex;
            position:relative; 
            overflow:hidden;
            display:flex; 
            justify-content:center; 
            align-items:center; 
            text-align: center;
            flex-direction:column;
            background:#fff0f5;
        }
        
        .decoContainer{
            width: 80%; 
            height:80%; 
            position:relative; 
            display:flex; 
            justify-content:center; 
            align-items:center; 
            overflow:hidden; 
            transition: transform 0.2s; 
        }
        
        .cake-deco{
            display:flex; 
            width:90%; 
            height: 80%; 
            flex-direction: column;
            position: relative;
            align-items:center; 
            justify-content:center; 
        }
        #cake-layer-1 ,#cake-layer-2, #cake-layer-3, #cream-1{
            border-radius: 10% 10% 0 0;
        }
        #cake-layer-1{
            background-color: #73b0ed;
            height: 25%;
            width: 80%;
            position: relative;
        }
        #cake-layer-2{
            height: 25%;
            width: 70%;
            background: linear-gradient(
                #815149 35%,   
                #ffffff 35%,  
                #ffffff 65%,  
                #815149 65%   
            );
        }
        #cake-layer-3{
            background-color: #fa9a9a;
            height: 20%;
            width: 60%;
        }
        #cream-1{
            height: 100%;
            background-size: 24% 200%;
            background-position: 0 60%;
            background-image: radial-gradient(circle at 50% 25%, #ffffff 32%, transparent 10%);
        }
        #top{
            display: flex;
            justify-content: space-around;
            width: 60%;
            height: 20%;
            align-items: baseline;
        }
        .cream{
            height: 40%;
            width: 10%;
            border-radius: 50%;
            background-color: #ffffff;
        }
        .candle{
            height: 100%;
            width: 10%; 
        }
        .wax{
            background-color: #ed4949;
            height: 70%;
            background: repeating-linear-gradient(
                45deg, #ed4949 0 15%,  
                #fc95c0 15% 30% 
            );
        }
        .fire{
            background-color: #ffc337;
            height: 30%;
            width: 80%;
            border-radius: 60% 60% 40% 40%;
            animation-delay: 2s;
            margin: auto;
        }
        @keyframes flicker {
            0%   { transform: scale(1) rotate(-2deg); opacity: 0.9; }
            50%  { transform: scale(1.1) rotate(2deg); opacity: 1; }
            100% { transform: scale(0.95) rotate(-1deg); opacity: 0.85; }
        }

        .heart-deco{
            width: 50%;
            height: auto;
            aspect-ratio: 1/1;
            background-color: #ff77c2;
            transform: rotate(-45deg);
            border-radius: 5%;
            animation-delay: 2s;
        }
        .heart-deco::before, .heart-deco::after{
            content: "";
            position: absolute;
            background-color: #ff77c2;
            border-radius: 50%;
            width: 100%;
            height: 100%;
        }
        .heart-deco::before{
            top:-50%;
            left:0;
        }
        .heart-deco::after{
            top:0;
            left:50%;
        }

        @keyframes heartbeat {
            0% {transform: rotate(-45deg) scale(0.7);}
            50% {transform: rotate(-45deg) scale(1);}
            100% {transform: rotate(-45deg) scale(0.7);}
        }

        @keyframes glow {
            0%   { filter: drop-shadow(0 0 2px #ffcde9) drop-shadow(0 0 5px #fb9acf) drop-shadow(0 0 2px #ffcde9); }
            50%  { filter: drop-shadow(0 0 4px #ffcde9) drop-shadow(0 0 10px #fb9acf) drop-shadow(0 0 4px #ffcde9); }
            100% { filter: drop-shadow(0 0 2px #ffcde9) drop-shadow(0 0 5px #fb9acf) drop-shadow(0 0 2px #ffcde9); }
        }

        .tree-deco {
            position: relative;
            display: flex;
            width: 100%;
            height: 100%;
            align-items: center;
            flex-direction: column;
            justify-content: center;
        }
        .tree-star{
            width: 30%;
            aspect-ratio: 1 / 1 ;
            background: #fdd543;
            clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
            z-index: 4;
        }
        .tree-leaves{
            position: relative;
            width: 0;
            height: 0;
        }
        .tree-leaves:nth-child(2){
            margin-top: -20%;
            width: 60%;
            height: 30%;
            background-color: #2e8b57;
            clip-path: polygon(50% 0%, 0% 100%, 100% 100%);   
            z-index: 2;
        }
        .tree-leaves:nth-child(3){
            margin-top: -25%;
            width: 75%;
            height: 40%;
            background-color: #2e8b57;
            clip-path: polygon(50% 0%, 0% 100%, 100% 100%);
            z-index: 1;   
        }
        .tree-leaves:nth-child(4){
            margin-top: -30%;
            width: 100%;
            height: 50%;
            background-color: #2e8b57;
            clip-path: polygon(50% 0%, 0% 100%, 100% 100%);   
        }
        .tree-trunk {
            width: 20%;
            height: 15%;
            background: #8b4513;
            border-radius: 0 0 10% 10%;
        }
        .ornament {
            position: absolute;
            width: 10%;
            aspect-ratio: 1/1;
            border-radius: 50%;
            z-index: 4;
            background:red;
        }
        .ornament.blue { background: #4aa3ff; }
        .ornament.gold { background: #ffd700; }
        .ornament.pink { background: #ff66b2; }

        .light {
            position: absolute;
            width: 5%;
            aspect-ratio: 1/1;
            border-radius: 50%;
            background: yellow;
            box-shadow: 0 0 4px yellow;
            animation: blink 1s infinite alternate;
            z-index: 3;
        }
        .light.red { background: #ff3333; box-shadow: 0 0 4px #ff3333; animation-delay: 0.2s; }
        .light.green { background: #00ff88; box-shadow: 0 0 4px #00ff88; animation-delay: 0.4s; }
        .light.blue { background: #98f5ff; box-shadow: 0 0 4px #98f5ff; animation-delay: 0.6s; }

        @keyframes redGlow {
            0% {filter: drop-shadow(0 0 2px #ff282879) drop-shadow(0 0 5px #fe9696);}
            50% {filter: drop-shadow(0 0 4px #ff4040) drop-shadow(0 0 10px #ff6060);}
            100% {filter: drop-shadow(0 0 2px #ff282879) drop-shadow(0 0 5px #fe9696);}
        }

        @keyframes blueGlow {
            0%   { filter: drop-shadow(0 0 2px #77aaff79) drop-shadow(0 0 5px #77aaff); }
            50%  { filter: drop-shadow(0 0 4px #77aaff) drop-shadow(0 0 10px #99ccff); }
            100% { filter: drop-shadow(0 0 2px #77aaff79) drop-shadow(0 0 5px #77aaff); }
        }

        @keyframes yellowGlow {
            0%   { filter: drop-shadow(0 0 2px #ffd70079) drop-shadow(0 0 5px #ffd700); }
            50%  { filter: drop-shadow(0 0 4px #ffd700) drop-shadow(0 0 10px #ffea70); }
            100% { filter: drop-shadow(0 0 2px #ffd70079) drop-shadow(0 0 5px #ffd700); }
        }

        @keyframes greenGlow {
            0%   { filter: drop-shadow(0 0 2px #33ff3379) drop-shadow(0 0 5px #33ff33); }
            50%  { filter: drop-shadow(0 0 4px #33ff33) drop-shadow(0 0 10px #70ff70); }
            100% { filter: drop-shadow(0 0 2px #33ff3379) drop-shadow(0 0 5px #33ff33); }
        }

        @media (min-width: 600px) {
            .fire {
                animation: flicker 0.6s infinite alternate;
                animation-delay: 2s;
            }
            .heart-deco {
                animation: heartbeat 1s infinite, glow 1s infinite alternate;
                animation-delay: 2s;
            }
            .light.red { background: #ff3333; animation: redGlow 1.2s infinite alternate; }
            .light.blue { background: #77aaff; animation: blueGlow 1.2s infinite alternate; }
            .light { background: #ffd700; animation: yellowGlow 1.2s infinite alternate; }
            .light.green { background: #33ff33; animation: greenGlow 1.2s infinite alternate; }
        }
        @media (max-width: 599px) {
            .fire, .heart-deco, .light, .light.green, .light.blue , .light.red {
                animation: none !important;
            }
        }

    </style>
    </head>
    <body>
        <div id="mainContainer">
            <div id="formContainer">
                <label id="title">Custom Card Generator</label>
                <input type="text" id="titleInput" placeholder="Happy Birthday!">
                <input type="text" id="cardRecipient" placeholder="Card Recipient">
                <textarea type="text" id="wishesInput" placeholder="Wish you all the best"></textarea>
                <label> Text Color: <input type="color" id="textColorInput" value="#ff80bf"></label>
                <label> Card Color: <input type="color" id="cardColorInput" value="#fbdafe"></label>
                <label>
                    Decoration: 
                    <select id="decoInput">
                        <option value="cake">Cake</option>
                        <option value="heart">Heart</option>
                        <option value="christmas-tree">Christmas Tree</option>
                    </select>
                </label>
                <button id="generateButton">Generate Card</button>
                <p id="linkOutput"></p>
            </div>

            <div id="cardContainer">
                <div class="card" id="card">
                    <div class="front" id="front">
                        <h2 id="frontTitle">Card Title</h2>
                        <h3 id="frontName">For Receiver</h3>
                        <div id="openButton">Click to open</div>
                    </div>
                    <div class="cardinside" id="cardInside">
                        <div class="left" id="leftPage">
                            <div class="decoContainer" id="cardDecoration"></div>
                        </div>
                        <div class="right" id="rightPage">
                            <h1 id="insideTitle">Card Title</h1>
                            <h2 id="insideName">For Receiver</h2>
                            <p id="wishes">Your wishes will appear here...</>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="sparkles"></div>

        <script>
            const front = document.getElementById('front');           
            const cardInside = document.getElementById('cardInside'); 
            const leftPage = document.getElementById('leftPage');     
            const rightPage = document.getElementById('rightPage');   
            const decoration = document.getElementById('cardDecoration');
            const wishes = document.getElementById('wishes');    
            const cardContainer = document.getElementById('cardContainer'); 
            const card = document.getElementById('card');            
            let currentCardData = null;                              

            const titleInput = document.getElementById('titleInput');
            const nameInput = document.getElementById('cardRecipient');
            const wishesInput = document.getElementById('wishesInput');
            const textColor = document.getElementById('textColorInput');
            const cardColor = document.getElementById('cardColorInput');
            const decorationInput = document.getElementById('decoInput');

            const generateBtn = document.getElementById('generateButton');
            const openBtn = document.getElementById('openButton');

            const cakeDeco = `<div class="cake-deco">
                                    <div id="top"><div class="cream"></div>
                                        <div class="candle">
                                            <div class="fire"></div>
                                            <div class="wax"></div>
                                            </div>
                                        <div class="cream"></div>
                                        <div class="candle">
                                            <div class="fire"></div>
                                            <div class="wax"></div>
                                        </div>
                                        <div class="cream"></div>
                                        <div class="candle">
                                            <div class="fire"></div>
                                            <div class="wax"></div>
                                            </div>
                                        <div class="cream"></div>
                                    </div>
                                    <div id="cake-layer-3">
                                        <div id="cream-1"></div>
                                    </div>
                                    <div id="cake-layer-2"></div>
                                    <div id="cake-layer-1"></div>
                                </div>`;
            const heartDeco = '<div class="heart-deco"></div>';
            const christmasTreeDeco = `<div class="tree-deco">
                                            <div class="tree-star"></div>
                                            <div class="tree-leaves">
                                                <div class="ornament pink" style="top:40%; left:30%;"></div>
                                                <div class="ornament" style="top:50%; left:65%;"></div>
                                                <div class="ornament gold" style="top:80%; left:15%;"></div>
                                                <div class="ornament blue" style="top:80%; left:60%;"></div>
                                                <div class="light" style="top:50%; left:50%;"></div>
                                                <div class="light green" style="top:75%; left:75%;"></div>
                                                <div class="light red" style="top:80%; left:40%;"></div>
                                            </div>
                                            <div class="tree-leaves">
                                                <div class="ornament blue" style="top:53%; left:35%;"></div>
                                                <div class="ornament gold" style="top:50%; left:65%;"></div>
                                                <div class="ornament" style="top:70%; left:20%;"></div>
                                                <div class="ornament pink" style="top:85%; left:60%;"></div>
                                                <div class="light" style="top:55%; left:54%;"></div>
                                                <div class="light blue" style="top:80%; left:40%;"></div>
                                                <div class="light red" style="top:75%; left:80%;"></div>
                                            </div>
                                            <div class="tree-leaves">
                                                <div class="ornament blue" style="top:50%; left:57%;"></div>
                                                <div class="ornament gold" style="top:50%; left:27%;"></div>
                                                <div class="ornament gold" style="top:65%; left:75%;"></div>
                                                <div class="ornament" style="top:80%; left:55%;"></div>
                                                <div class="ornament pink" style="top:80%; left:15%;"></div>
                                                <div class="light" style="top:75%; left:30%;"></div>
                                                <div class="light blue" style="top:50%; left:40%;"></div>
                                                <div class="light" style="top:64%; left:50%;"></div>
                                                <div class="light green" style="top:55%; left:70%;"></div>
                                                <div class="light red" style="top:85%; left:85%;"></div>
                                                <div class="light green" style="top:80%; left:70%;"></div>
                                                <div class="light blue" style="top:87%; left:43%;"></div>
                                            </div>
                                            <div class="tree-trunk"></div>
                                        </div>`

            function fillCard(data){
                currentCardData = data;

                front.style.background = data.cardColor;
                leftPage.style.background = data.cardColor;
                rightPage.style.background = data.cardColor;

                front.style.color=data.textColor;
                leftPage.style.color=data.textColor;
                rightPage.style.color=data.textColor;
                openBtn.style.color=data.textColor;
                openBtn.style.borderColor=data.textColor;

                document.getElementById('frontTitle').textContent = data.title || 'Card Title';
                document.getElementById('frontName').textContent = 'For ' + (data.name || 'Receiver');
                document.getElementById('insideTitle').textContent = data.title || 'Card Title';
                document.getElementById('insideName').textContent = 'For ' + (data.name || 'Receiver');
                wishes.textContent = data.wish || 'Your wishes will appear here...';
  
                decoration.innerHTML = '';
                if (data.deco === 'cake') {
                    decoration.innerHTML = cakeDeco;
                } else if (data.deco === 'heart') {
                    decoration.innerHTML = heartDeco;
                } else if (data.deco === 'christmas-tree') {
                    decoration.innerHTML = christmasTreeDeco;
                }
            }

            function updatePreview(){
                const data = {
                    title: titleInput.value,
                    name: nameInput.value,
                    wish: wishesInput.value,
                    cardColor: cardColor.value,
                    textColor: textColor.value,
                    deco: decorationInput.value,
                };
                fillCard(data);
            }

            titleInput.addEventListener('input', updatePreview);
            nameInput.addEventListener('input', updatePreview);
            wishesInput.addEventListener('input', updatePreview);
            cardColor.addEventListener('input', updatePreview);
            textColor.addEventListener('input', updatePreview);
        
            decorationInput.addEventListener('change', () => {
                updatePreview();
                const decor = decorationInput.value;
                if (decor === 'cake') {
                    decoration.innerHTML = cakeDeco;
                } else if (decor === 'heart') {
                    decoration.innerHTML = heartDeco;
                } else if (data.deco === 'christmas-tree') {
                    decoration.innerHTML = christmasTreeDeco;
                }
            });

            generateBtn.addEventListener('click', () => {
                const data = {
                    title: titleInput.value,
                    name: nameInput.value,
                    wish: wishesInput.value,
                    cardColor: cardColor.value,
                    textColor: textColor.value,
                    deco: decorationInput.value,
                };
                const encoded = btoa(JSON.stringify(data));
                const link = window.location.href.split('?')[0] + '?data=' + encoded;
                document.getElementById('linkOutput').innerHTML = `<a href="${link}" target="_blank">Shareable E-Card Link</a>`;
            });

            openBtn.addEventListener('click', () => {
                front.style.transform = 'rotateY(-120deg)';
                cardInside.style.transform='rotateY(0deg)';
            });

            function closeCard(){
                front.style.transform='rotateY(0deg)';
                cardInside.style.transform='rotateY(0deg)';
            }

            leftPage.addEventListener('click', closeCard);
            rightPage.addEventListener('click', closeCard);

            function starteffects(){
                if(effectInterval) clearInterval(effectInterval);

                if(!currentCardData || !currentCardData.effects) return;
            }

            function loadURL(){
                const params = new URLSearchParams(window.location.search);
                if(params.has('data')){
                    const data = JSON.parse(atob(params.get('data')));
                    fillCard(data);
                    document.getElementById('formContainer').style.display='none';
                    document.querySelector('.mainContainer').style.justifyItem = 'center';
                    cardContainer.style.display='block';
                }
            }

            loadURL();

            updatePreview();
    
        </script>
    </body>
</html>